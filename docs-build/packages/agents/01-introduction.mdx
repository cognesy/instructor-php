---
title: Introduction
description: 'Overview of the Agents SDK for building LLM-powered agents that reason and act through tool use'
---

# Introduction

The Agents package provides a minimal, composable foundation for building LLM-powered agents that reason and act through tool use.

At its core, an agent is a **loop**: send messages to an LLM, receive a response (possibly with tool calls), execute those tools, feed results back, and repeat until done.

## Key Design Principles

- **Immutable state** - `AgentState` is a readonly value object. Every mutation returns a new instance.
- **Pluggable drivers** - Swap between `ToolCallingDriver` (native function calling) and `ReActDriver` (Thought/Action/Observation) without changing your agent code.
- **Lifecycle hooks** - Intercept any phase of execution to add guards, logging, or custom behavior.
- **Testable by default** - `FakeAgentDriver` lets you script deterministic scenarios without LLM calls.

## Two Layers

**AgentLoop** is the stateless execution engine. It takes an `AgentState`, runs the step loop, and returns the final state. Use it directly for simple agents or full manual control.

**AgentBuilder** is the composition layer. It assembles an `AgentLoop` from pluggable capabilities (`Use*` classes) that install tools, hooks, guards, drivers, and compilers. Use it when you want modular, reusable configuration.

```php
// Direct: AgentLoop
$loop = AgentLoop::default()->withTool($myTool);

// Composed: AgentBuilder
$agent = AgentBuilder::base()
    ->withCapability(new UseBash())
    ->withCapability(new UseGuards(maxSteps: 10))
    ->build();
// @doctest id="29c6"
```

## Package Structure

```
AgentLoop.php         # Core execution loop
CanControlAgentLoop   # Loop interface (execute/iterate)
Builder/              # AgentBuilder, AgentConfigurator, capability contracts
Capability/           # Use* capabilities (Core, Bash, File, Subagent, etc.)
Collections/          # Tools, AgentSteps, StepExecutions, ErrorList, etc.
Context/              # AgentContext, message compilers (CanCompileMessages)
Continuation/         # StopSignal, StopReason, ExecutionContinuation
Data/                 # AgentState, ExecutionState, AgentStep, AgentBudget
Drivers/              # ToolCallingDriver, ReActDriver, FakeAgentDriver
Enums/                # AgentStepType, ExecutionStatus
Events/               # Agent event system
Exceptions/           # Domain exceptions
Hook/                 # HookStack, HookInterface, HookContext, built-in hooks
Interception/         # CanInterceptAgentLifecycle, PassThroughInterceptor
Template/             # Agent definitions, parsers, registry
Tool/                 # ToolInterface, BaseTool, FunctionTool, ToolExecutor
// @doctest id="4b57"
```

## Minimal Example

```php
use Cognesy\Agents\AgentLoop;use Cognesy\Agents\Data\AgentState;

$loop = AgentLoop::default();
$state = AgentState::empty()->withUserMessage('Hello!');
$result = $loop->execute($state);

echo $result->finalResponse()->toString();
// @doctest id="a23d"
```
